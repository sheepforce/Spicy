<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Spicy.Types
Description : Data types used in the Spicy program.
Copyright   : Phillip Seeber, 2019
License     : GPL-3
Maintainer  : phillip.seeber@uni-jena.de
Stability   : experimental
Portability : POSIX, Windows

Spicy.Types contains the definition of all classes and data types, that are used in Spicy. Mainly it
takes care of the description of molecules (structure, topology, potential energy surface, ...).
-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass  #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric   #-}</span><span>
</span><a name="line-15"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Spicy.Types</span><span>
</span><a name="line-16"></a><span class="hs-special">(</span><span> </span><a href="Spicy.Types.html#Strat"><span class="hs-identifier hs-type">Strat</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#UMatrix"><span class="hs-identifier hs-type">UMatrix</span></a><span>
</span><a name="line-18"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#Element"><span class="hs-identifier hs-type">Element</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#AtomLabel"><span class="hs-identifier hs-type">AtomLabel</span></a><span>
</span><a name="line-20"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#FFType"><span class="hs-identifier hs-type">FFType</span></a><span>
</span><a name="line-21"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#Atom"><span class="hs-identifier hs-type">Atom</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#atom_Element"><span class="hs-identifier hs-var">atom_Element</span></a><span>
</span><a name="line-23"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#atom_Label"><span class="hs-identifier hs-var">atom_Label</span></a><span>
</span><a name="line-24"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#atom_IsPseudo"><span class="hs-identifier hs-var">atom_IsPseudo</span></a><span>
</span><a name="line-25"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#atom_FFType"><span class="hs-identifier hs-var">atom_FFType</span></a><span>
</span><a name="line-26"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#atom_PCharge"><span class="hs-identifier hs-var">atom_PCharge</span></a><span>
</span><a name="line-27"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#atom_Coordinates"><span class="hs-identifier hs-var">atom_Coordinates</span></a><span>
</span><a name="line-28"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#Molecule"><span class="hs-identifier hs-type">Molecule</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_Label"><span class="hs-identifier hs-var">molecule_Label</span></a><span>
</span><a name="line-30"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_Atoms"><span class="hs-identifier hs-var">molecule_Atoms</span></a><span>
</span><a name="line-31"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_Bonds"><span class="hs-identifier hs-var">molecule_Bonds</span></a><span>
</span><a name="line-32"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_SubMol"><span class="hs-identifier hs-var">molecule_SubMol</span></a><span>
</span><a name="line-33"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_Energy"><span class="hs-identifier hs-var">molecule_Energy</span></a><span>
</span><a name="line-34"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_Gradient"><span class="hs-identifier hs-var">molecule_Gradient</span></a><span>
</span><a name="line-35"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#molecule_Hessian"><span class="hs-identifier hs-var">molecule_Hessian</span></a><span>
</span><a name="line-36"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Types.html#Trajectory"><span class="hs-identifier hs-type">Trajectory</span></a><span>
</span><a name="line-37"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.DeepSeq</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.IntMap.Lazy</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IntMap</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.IntSet</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IntSet</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector.Storable</span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VS</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Generics</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Lens.Micro.Platform</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Array.Unboxed</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">AU</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Sequence</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Seq</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">{-|
Have a class for the printing of the calculation niveau, which allows to produce a very readable
output.
-}</span><span>
</span><a name="line-52"></a><span class="hs-keyword">class</span><span> </span><a name="NiceShow"><a href="Spicy.Types.html#NiceShow"><span class="hs-identifier">NiceShow</span></a></a><span> </span><a name="local-6989586621679101122"><a href="#local-6989586621679101122"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>  </span><a name="niceShow"><a href="Spicy.Types.html#niceShow"><span class="hs-identifier">niceShow</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679101122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ Printing the isolated object</span><span>
</span><a name="line-54"></a><span>  </span><a name="niceComplex"><a href="Spicy.Types.html#niceComplex"><span class="hs-identifier">niceComplex</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679101122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ Printing the object in the complex form,</span><span>
</span><a name="line-55"></a><span>                             </span><span class="hs-comment">--   where everything is meant to be printed at once as overview</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">{-|
Use serial or parallel processing for large data structures. This helps deciding on a per use base,
if to evaluate in serial or parallel, to avoid nested parallelism. Every method employing parallel
operations by Control.Parallel.Strategies should provide this switch in Spicy.
-}</span><span>
</span><a name="line-62"></a><span class="hs-keyword">data</span><span> </span><a name="Strat"><a href="Spicy.Types.html#Strat"><span class="hs-identifier">Strat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Serial"><a href="Spicy.Types.html#Serial"><span class="hs-identifier">Serial</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Parallel"><a href="Spicy.Types.html#Parallel"><span class="hs-identifier">Parallel</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">{-|
Alias for an unboxed matrix from the Array library. This type can easily be converted to
Accelerate's array type.
-}</span><span>
</span><a name="line-68"></a><span class="hs-keyword">type</span><span> </span><a name="UMatrix"><a href="Spicy.Types.html#UMatrix"><span class="hs-identifier">UMatrix</span></a></a><span> </span><a name="local-6989586621679100676"><a href="#local-6989586621679100676"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">AU.Array</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100676"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">----------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-71"></a><span class="hs-comment">{- $moleculeTypes
Types to describe a molecule from a computational geometry point of view. The representation of a
molecule aims to be as descriptive as unambigous as possible and capture all quantities relevant for
molecular dynamics and geometry optimisations (energies, gradients, hessians, force fiekd types,
coordinates, connectivities). Electronic properties, such as dipoles, orbitals, the wavefunction and
so on, will be ignored, as Spicy is not aiming to be an analysis program, but a interface to create
multilayer calculations. Analysis of the results is up to postprocessing.
-}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">{-|
All chemical elements. Have them very clear because force fields and pdb names may interfer and are
just arbitrary strings.
-}</span><span>
</span><a name="line-84"></a><span class="hs-keyword">data</span><span> </span><a name="Element"><a href="Spicy.Types.html#Element"><span class="hs-identifier">Element</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-85"></a><span>  </span><a name="H"><a href="Spicy.Types.html#H"><span class="hs-identifier">H</span></a></a><span>   </span><span class="hs-glyph">|</span><span>                                                                                                                                                                                     </span><a name="He"><a href="Spicy.Types.html#He"><span class="hs-identifier">He</span></a></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-86"></a><span>  </span><a name="Li"><a href="Spicy.Types.html#Li"><span class="hs-identifier">Li</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Be"><a href="Spicy.Types.html#Be"><span class="hs-identifier">Be</span></a></a><span>                                                                                                                                                  </span><span class="hs-glyph">|</span><span> </span><a name="B"><a href="Spicy.Types.html#B"><span class="hs-identifier">B</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="C"><a href="Spicy.Types.html#C"><span class="hs-identifier">C</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="N"><a href="Spicy.Types.html#N"><span class="hs-identifier">N</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="O"><a href="Spicy.Types.html#O"><span class="hs-identifier">O</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="F"><a href="Spicy.Types.html#F"><span class="hs-identifier">F</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Ne"><a href="Spicy.Types.html#Ne"><span class="hs-identifier">Ne</span></a></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-87"></a><span>  </span><a name="Na"><a href="Spicy.Types.html#Na"><span class="hs-identifier">Na</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Mg"><a href="Spicy.Types.html#Mg"><span class="hs-identifier">Mg</span></a></a><span>                                                                                                                                                  </span><span class="hs-glyph">|</span><span> </span><a name="Al"><a href="Spicy.Types.html#Al"><span class="hs-identifier">Al</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Si"><a href="Spicy.Types.html#Si"><span class="hs-identifier">Si</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="P"><a href="Spicy.Types.html#P"><span class="hs-identifier">P</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="S"><a href="Spicy.Types.html#S"><span class="hs-identifier">S</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Cl"><a href="Spicy.Types.html#Cl"><span class="hs-identifier">Cl</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ar"><a href="Spicy.Types.html#Ar"><span class="hs-identifier">Ar</span></a></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-88"></a><span>  </span><a name="K"><a href="Spicy.Types.html#K"><span class="hs-identifier">K</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Ca"><a href="Spicy.Types.html#Ca"><span class="hs-identifier">Ca</span></a></a><span>                                                                                      </span><span class="hs-glyph">|</span><span> </span><a name="Sc"><a href="Spicy.Types.html#Sc"><span class="hs-identifier">Sc</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ti"><a href="Spicy.Types.html#Ti"><span class="hs-identifier">Ti</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="V"><a href="Spicy.Types.html#V"><span class="hs-identifier">V</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Cr"><a href="Spicy.Types.html#Cr"><span class="hs-identifier">Cr</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Mn"><a href="Spicy.Types.html#Mn"><span class="hs-identifier">Mn</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Fe"><a href="Spicy.Types.html#Fe"><span class="hs-identifier">Fe</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Co"><a href="Spicy.Types.html#Co"><span class="hs-identifier">Co</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ni"><a href="Spicy.Types.html#Ni"><span class="hs-identifier">Ni</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cu"><a href="Spicy.Types.html#Cu"><span class="hs-identifier">Cu</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Zn"><a href="Spicy.Types.html#Zn"><span class="hs-identifier">Zn</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ga"><a href="Spicy.Types.html#Ga"><span class="hs-identifier">Ga</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ge"><a href="Spicy.Types.html#Ge"><span class="hs-identifier">Ge</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="As"><a href="Spicy.Types.html#As"><span class="hs-identifier">As</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Se"><a href="Spicy.Types.html#Se"><span class="hs-identifier">Se</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Br"><a href="Spicy.Types.html#Br"><span class="hs-identifier">Br</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Kr"><a href="Spicy.Types.html#Kr"><span class="hs-identifier">Kr</span></a></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-89"></a><span>  </span><a name="Rb"><a href="Spicy.Types.html#Rb"><span class="hs-identifier">Rb</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sr"><a href="Spicy.Types.html#Sr"><span class="hs-identifier">Sr</span></a></a><span>                                                                                      </span><span class="hs-glyph">|</span><span> </span><a name="Y"><a href="Spicy.Types.html#Y"><span class="hs-identifier">Y</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Zr"><a href="Spicy.Types.html#Zr"><span class="hs-identifier">Zr</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Nb"><a href="Spicy.Types.html#Nb"><span class="hs-identifier">Nb</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Mo"><a href="Spicy.Types.html#Mo"><span class="hs-identifier">Mo</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Tc"><a href="Spicy.Types.html#Tc"><span class="hs-identifier">Tc</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ru"><a href="Spicy.Types.html#Ru"><span class="hs-identifier">Ru</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Rh"><a href="Spicy.Types.html#Rh"><span class="hs-identifier">Rh</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pd"><a href="Spicy.Types.html#Pd"><span class="hs-identifier">Pd</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ag"><a href="Spicy.Types.html#Ag"><span class="hs-identifier">Ag</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cd"><a href="Spicy.Types.html#Cd"><span class="hs-identifier">Cd</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="In"><a href="Spicy.Types.html#In"><span class="hs-identifier">In</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sn"><a href="Spicy.Types.html#Sn"><span class="hs-identifier">Sn</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sb"><a href="Spicy.Types.html#Sb"><span class="hs-identifier">Sb</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Te"><a href="Spicy.Types.html#Te"><span class="hs-identifier">Te</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="I"><a href="Spicy.Types.html#I"><span class="hs-identifier">I</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Xe"><a href="Spicy.Types.html#Xe"><span class="hs-identifier">Xe</span></a></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-90"></a><span>  </span><a name="Cs"><a href="Spicy.Types.html#Cs"><span class="hs-identifier">Cs</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ba"><a href="Spicy.Types.html#Ba"><span class="hs-identifier">Ba</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="La"><a href="Spicy.Types.html#La"><span class="hs-identifier">La</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ce"><a href="Spicy.Types.html#Ce"><span class="hs-identifier">Ce</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pr"><a href="Spicy.Types.html#Pr"><span class="hs-identifier">Pr</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Nd"><a href="Spicy.Types.html#Nd"><span class="hs-identifier">Nd</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pm"><a href="Spicy.Types.html#Pm"><span class="hs-identifier">Pm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sm"><a href="Spicy.Types.html#Sm"><span class="hs-identifier">Sm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Eu"><a href="Spicy.Types.html#Eu"><span class="hs-identifier">Eu</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Gd"><a href="Spicy.Types.html#Gd"><span class="hs-identifier">Gd</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Tb"><a href="Spicy.Types.html#Tb"><span class="hs-identifier">Tb</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Dy"><a href="Spicy.Types.html#Dy"><span class="hs-identifier">Dy</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ho"><a href="Spicy.Types.html#Ho"><span class="hs-identifier">Ho</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Er"><a href="Spicy.Types.html#Er"><span class="hs-identifier">Er</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Tm"><a href="Spicy.Types.html#Tm"><span class="hs-identifier">Tm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Yb"><a href="Spicy.Types.html#Yb"><span class="hs-identifier">Yb</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Lu"><a href="Spicy.Types.html#Lu"><span class="hs-identifier">Lu</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Hf"><a href="Spicy.Types.html#Hf"><span class="hs-identifier">Hf</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ta"><a href="Spicy.Types.html#Ta"><span class="hs-identifier">Ta</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="W"><a href="Spicy.Types.html#W"><span class="hs-identifier">W</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Re"><a href="Spicy.Types.html#Re"><span class="hs-identifier">Re</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Os"><a href="Spicy.Types.html#Os"><span class="hs-identifier">Os</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ir"><a href="Spicy.Types.html#Ir"><span class="hs-identifier">Ir</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pt"><a href="Spicy.Types.html#Pt"><span class="hs-identifier">Pt</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Au"><a href="Spicy.Types.html#Au"><span class="hs-identifier">Au</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Hg"><a href="Spicy.Types.html#Hg"><span class="hs-identifier">Hg</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Tl"><a href="Spicy.Types.html#Tl"><span class="hs-identifier">Tl</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pb"><a href="Spicy.Types.html#Pb"><span class="hs-identifier">Pb</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Bi"><a href="Spicy.Types.html#Bi"><span class="hs-identifier">Bi</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Po"><a href="Spicy.Types.html#Po"><span class="hs-identifier">Po</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="At"><a href="Spicy.Types.html#At"><span class="hs-identifier">At</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Rn"><a href="Spicy.Types.html#Rn"><span class="hs-identifier">Rn</span></a></a><span>  </span><span class="hs-glyph">|</span><span>
</span><a name="line-91"></a><span>  </span><a name="Fr"><a href="Spicy.Types.html#Fr"><span class="hs-identifier">Fr</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ra"><a href="Spicy.Types.html#Ra"><span class="hs-identifier">Ra</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ac"><a href="Spicy.Types.html#Ac"><span class="hs-identifier">Ac</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Th"><a href="Spicy.Types.html#Th"><span class="hs-identifier">Th</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pa"><a href="Spicy.Types.html#Pa"><span class="hs-identifier">Pa</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="U"><a href="Spicy.Types.html#U"><span class="hs-identifier">U</span></a></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="Np"><a href="Spicy.Types.html#Np"><span class="hs-identifier">Np</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Pu"><a href="Spicy.Types.html#Pu"><span class="hs-identifier">Pu</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Am"><a href="Spicy.Types.html#Am"><span class="hs-identifier">Am</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cm"><a href="Spicy.Types.html#Cm"><span class="hs-identifier">Cm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Bk"><a href="Spicy.Types.html#Bk"><span class="hs-identifier">Bk</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cf"><a href="Spicy.Types.html#Cf"><span class="hs-identifier">Cf</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Es"><a href="Spicy.Types.html#Es"><span class="hs-identifier">Es</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Fm"><a href="Spicy.Types.html#Fm"><span class="hs-identifier">Fm</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Md"><a href="Spicy.Types.html#Md"><span class="hs-identifier">Md</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="No"><a href="Spicy.Types.html#No"><span class="hs-identifier">No</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Lr"><a href="Spicy.Types.html#Lr"><span class="hs-identifier">Lr</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Rf"><a href="Spicy.Types.html#Rf"><span class="hs-identifier">Rf</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Db"><a href="Spicy.Types.html#Db"><span class="hs-identifier">Db</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Sg"><a href="Spicy.Types.html#Sg"><span class="hs-identifier">Sg</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Bh"><a href="Spicy.Types.html#Bh"><span class="hs-identifier">Bh</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Hs"><a href="Spicy.Types.html#Hs"><span class="hs-identifier">Hs</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Mt"><a href="Spicy.Types.html#Mt"><span class="hs-identifier">Mt</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Ds"><a href="Spicy.Types.html#Ds"><span class="hs-identifier">Ds</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Rg"><a href="Spicy.Types.html#Rg"><span class="hs-identifier">Rg</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Cn"><a href="Spicy.Types.html#Cn"><span class="hs-identifier">Cn</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Uut"><a href="Spicy.Types.html#Uut"><span class="hs-identifier">Uut</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Fl"><a href="Spicy.Types.html#Fl"><span class="hs-identifier">Fl</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Uup"><a href="Spicy.Types.html#Uup"><span class="hs-identifier">Uup</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lv"><a href="Spicy.Types.html#Lv"><span class="hs-identifier">Lv</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Uus"><a href="Spicy.Types.html#Uus"><span class="hs-identifier">Uus</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Uuo"><a href="Spicy.Types.html#Uuo"><span class="hs-identifier">Uuo</span></a></a><span>
</span><a name="line-92"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">{-|
An atom label. They may come from pdb or force field parameter files or can be assigned by other
ways just to distinguish specific atoms.
-}</span><span>
</span><a name="line-98"></a><span class="hs-keyword">type</span><span> </span><a name="AtomLabel"><a href="Spicy.Types.html#AtomLabel"><span class="hs-identifier">AtomLabel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">{-|
These are labels for molecular mechanics software. The strings are basically arbitrary and depending
on the MM software used.
-}</span><span>
</span><a name="line-104"></a><span class="hs-keyword">type</span><span> </span><a name="FFType"><a href="Spicy.Types.html#FFType"><span class="hs-identifier">FFType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">{-|
An Atom in a 'Molecule'. Atoms are compared by their indices only and they must therefore be unique.
The coordinates of the 'Atom' are defined as 'Seq', as this is extremely easy to concatenate when
building a coordinate vector.
-}</span><span>
</span><a name="line-111"></a><span class="hs-keyword">data</span><span> </span><a name="Atom"><a href="Spicy.Types.html#Atom"><span class="hs-identifier">Atom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Atom"><a href="Spicy.Types.html#Atom"><span class="hs-identifier">Atom</span></a></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="_atom_Element"><a href="Spicy.Types.html#_atom_Element"><span class="hs-identifier">_atom_Element</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Spicy.Types.html#Element"><span class="hs-identifier hs-type">Element</span></a><span>      </span><span class="hs-comment">-- ^ Chemical 'Element' of the atom.</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_atom_Label"><a href="Spicy.Types.html#_atom_Label"><span class="hs-identifier">_atom_Label</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Spicy.Types.html#AtomLabel"><span class="hs-identifier hs-type">AtomLabel</span></a><span>    </span><span class="hs-comment">-- ^ Label, e.g. from a pdb, just for identification, can</span><span>
</span><a name="line-114"></a><span>                                      </span><span class="hs-comment">--   be empty.</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_atom_IsPseudo"><a href="Spicy.Types.html#_atom_IsPseudo"><span class="hs-identifier">_atom_IsPseudo</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>         </span><span class="hs-comment">-- ^ Boolean, telling if this is a pseudo atom, introduced</span><span>
</span><a name="line-116"></a><span>                                      </span><span class="hs-comment">--   because a bond was broken.</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_atom_FFType"><a href="Spicy.Types.html#_atom_FFType"><span class="hs-identifier">_atom_FFType</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Spicy.Types.html#FFType"><span class="hs-identifier hs-type">FFType</span></a><span>       </span><span class="hs-comment">-- ^ Label depending on the MM software used, identifying</span><span>
</span><a name="line-118"></a><span>                                      </span><span class="hs-comment">--   topological atom.</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_atom_PCharge"><a href="Spicy.Types.html#_atom_PCharge"><span class="hs-identifier">_atom_PCharge</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-comment">-- ^ Possibly a partial charge.</span><span>
</span><a name="line-120"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_atom_Coordinates"><a href="Spicy.Types.html#_atom_Coordinates"><span class="hs-identifier">_atom_Coordinates</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Seq</span><span> </span><span class="hs-identifier hs-type">Double</span><span>   </span><span class="hs-comment">-- ^ Coordinates of the atom, cartesian in R&#179;. Relies on</span><span>
</span><a name="line-121"></a><span>                                      </span><span class="hs-comment">--   the parser to fill with exactly 3 values.</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span class="hs-identifier hs-var">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Atom</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">{-|
A molecule, which might be the whole system, an ONIOM layer or a fragment of the system, each
containing possibly even higher layers for ONIOM or fragments. Stores all associated informations of
a layer.

Starting from a top level molecule, all atoms and bonds of the system are expected to be in the in
this top layer (except pseudoatoms of deeper layers). Therefore if atoms are in a deeper layers of
the recursion, their information is not used to describe a higher layer. Instead, all atoms of
deeper layers (except pseudoatoms) must be also replicated in a higher layer.

Two possible types of index countings are possible:

  - __/'Global'/__: All atoms in the system (which should be present at the top layer molecule) except
    pseudoatoms are counted in the top layer. The fragments might therefore not start at atom with
    index 0, but depending on where they are in a higher level with higher numbers. Pseudoatoms are
    counted after all other atoms are counted.
  - __/'Individual'/__: Counting happens for each molecule individually. In this counting scheme,
    pseudoatoms do not need any special treatment.
-}</span><span>
</span><a name="line-144"></a><span class="hs-keyword">data</span><span> </span><a name="Molecule"><a href="Spicy.Types.html#Molecule"><span class="hs-identifier">Molecule</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Molecule"><a href="Spicy.Types.html#Molecule"><span class="hs-identifier">Molecule</span></a></a><span>
</span><a name="line-145"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="_molecule_Label"><a href="Spicy.Types.html#_molecule_Label"><span class="hs-identifier">_molecule_Label</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>                   </span><span class="hs-comment">-- ^ Comment or identifier of a molecule. Can be</span><span>
</span><a name="line-146"></a><span>                                                   </span><span class="hs-comment">--   empty.</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_molecule_Atoms"><a href="Spicy.Types.html#_molecule_Atoms"><span class="hs-identifier">_molecule_Atoms</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><a href="Spicy.Types.html#Atom"><span class="hs-identifier hs-type">Atom</span></a><span>              </span><span class="hs-comment">-- ^ An 'IntMap' of 'Atom's, 'Atom's identified</span><span>
</span><a name="line-148"></a><span>                                                   </span><span class="hs-comment">--   by their 'Int' index.</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_molecule_Bonds"><a href="Spicy.Types.html#_molecule_Bonds"><span class="hs-identifier">_molecule_Bonds</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IntMap</span><span> </span><span class="hs-identifier hs-type">IntSet</span><span>            </span><span class="hs-comment">-- ^ An IntMap, mapping the index of an 'Atom' in</span><span>
</span><a name="line-150"></a><span>                                                   </span><span class="hs-comment">--   the 'Molecule' to the indices of all</span><span>
</span><a name="line-151"></a><span>                                                   </span><span class="hs-comment">--   'Atom's, to which it binds.</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_molecule_SubMol"><a href="Spicy.Types.html#_molecule_SubMol"><span class="hs-identifier">_molecule_SubMol</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Seq</span><span> </span><a href="Spicy.Types.html#Molecule"><span class="hs-identifier hs-type">Molecule</span></a><span>             </span><span class="hs-comment">-- ^ A Molecule might contain other molecules.</span><span>
</span><a name="line-153"></a><span>                                                   </span><span class="hs-comment">--   These might be fragments or higher level</span><span>
</span><a name="line-154"></a><span>                                                   </span><span class="hs-comment">--   ONIOM layers.</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_molecule_Energy"><a href="Spicy.Types.html#_molecule_Energy"><span class="hs-identifier">_molecule_Energy</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>             </span><span class="hs-comment">-- ^ An energy, that might have been calculated.</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_molecule_Gradient"><a href="Spicy.Types.html#_molecule_Gradient"><span class="hs-identifier">_molecule_Gradient</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ A gradient, that might have been calculated.</span><span>
</span><a name="line-157"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="_molecule_Hessian"><a href="Spicy.Types.html#_molecule_Hessian"><span class="hs-identifier">_molecule_Hessian</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Spicy.Types.html#UMatrix"><span class="hs-identifier hs-type">UMatrix</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ A hessian, that might have been calculated.</span><span>
</span><a name="line-158"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span class="hs-identifier hs-var">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier hs-var">Molecule</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">{-|
Trajectories are simply 'Seq'uences of 'Molecule's.
-}</span><span>
</span><a name="line-164"></a><span class="hs-keyword">type</span><span> </span><a name="Trajectory"><a href="Spicy.Types.html#Trajectory"><span class="hs-identifier">Trajectory</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Seq</span><span> </span><a href="Spicy.Types.html#Molecule"><span class="hs-identifier hs-type">Molecule</span></a><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">----------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-168"></a><span class="hs-comment">{- $compChemTypes
Data types to describe the calculation niveau. They are hierarchically organised and try to cover
everything, so that Spicy is fully aware of the calculation niveau. This has the advantage, that
users basically do not need to know the input of a specific program to perform a Spicy calculation.
-}</span><span>
</span><a name="line-173"></a><span class="hs-comment">{-
{-|
Define commonon tasks for quantum chemistry software.
-}
data Task =
    Energy
  | Gradient
  | Hessian
  | PartialCharge
  deriving (Show, Eq)
instance NiceShow Task where
  niceShow    = show
  niceComplex = show

{-|
Software packages, that have been interfaced by Spicy.
-}
data Software =
    ORCA
  | Psi4
  | NWChem
  | CP2K
  | GAMMES_US
  | Tinker
  | MRCC
  deriving (Show, Eq)
instance NiceShow Software where
  niceShow ORCA      = &quot;ORCA&quot;
  niceShow Psi4      = &quot;Psi4&quot;
  niceShow NWChem    = &quot;NWChem&quot;
  niceShow CP2K      = &quot;CP2K&quot;
  niceShow GAMMES_US = &quot;GAMESS US&quot;
  niceShow Tinker    = &quot;Tinker&quot;
  niceShow MRCC      = &quot;MRCC&quot;
  niceComplex        = niceShow

{-|
Definition of basis sets. Prefer to have a prebuilt list, but allow for the option to use one, that
is not known here by the program specific (!) keyword ('CustomSimple') or by giving the program
specific (!) inline notation of the basis ('CustomComplex').
-}
data Basis =
  -- Ahlrich
    Def2_mSVP
  | Def2_mTZVP
  | Def2_SV_P
  | Def2_SVP
  | Def2_TZVP_f
  | Def2_TZVP
  | Def2_TZVPP
  | Def2_QZVP
  | Def2_QZVPP
  | Def2_SVPD
  | Def2_TZVPD
  | Def2_TZVPPD
  | Def2_QZVPD
  | Def2_QZVPPD
  -- Dunning
  | Cc_pVDZ
  | Cc_pVTZ
  | Cc_pVQZ
  | Cc_pV5Z
  | Cc_pV6Z
  | Aug_cc_pVDZ
  | Aug_cc_pVTZ
  | Aug_cc_pVQZ
  | Aug_cc_pV5Z
  | Aug_cc_pV6Z
  -- Custom basis set
  | CustomSimple String
  | CustomComplex String
  deriving (Show, Eq)
instance NiceShow Basis where
  niceShow Def2_mSVP         = &quot;def2-mSVP&quot;
  niceShow Def2_mTZVP        = &quot;def2-mTZVP&quot;
  niceShow Def2_SV_P         = &quot;def2-SV(P)&quot;
  niceShow Def2_SVP          = &quot;def2-SVP&quot;
  niceShow Def2_TZVP_f       = &quot;def-TZVP(-f)&quot;
  niceShow Def2_TZVP         = &quot;def2-TZVP&quot;
  niceShow Def2_TZVPP        = &quot;def2-TZVPP&quot;
  niceShow Def2_QZVP         = &quot;def2-QZVP&quot;
  niceShow Def2_QZVPP        = &quot;def2-QZVPP&quot;
  niceShow Def2_SVPD         = &quot;def2-SVPD&quot;
  niceShow Def2_TZVPD        = &quot;def2-TZVPD&quot;
  niceShow Def2_TZVPPD       = &quot;def2-TZVPPD&quot;
  niceShow Def2_QZVPD        = &quot;def2-QZVPD&quot;
  niceShow Def2_QZVPPD       = &quot;def2-QZVPPD&quot;
  niceShow Cc_pVDZ           = &quot;cc-pVDZ&quot;
  niceShow Cc_pVTZ           = &quot;cc-pVTZ&quot;
  niceShow Cc_pVQZ           = &quot;cc-pVQZ&quot;
  niceShow Cc_pV5Z           = &quot;cc-pV5Z&quot;
  niceShow Cc_pV6Z           = &quot;cc-pV6Z&quot;
  niceShow Aug_cc_pVDZ       = &quot;aug-cc-pVDZ&quot;
  niceShow Aug_cc_pVTZ       = &quot;aug-cc-pVTZ&quot;
  niceShow Aug_cc_pVQZ       = &quot;aug-cc-pVQZ&quot;
  niceShow Aug_cc_pV5Z       = &quot;aug-cc-pV5Z&quot;
  niceShow Aug_cc_pV6Z       = &quot;aug-cc-pV6Z&quot;
  niceShow (CustomSimple a)  = a
  niceShow (CustomComplex a) = a
  niceComplex                = niceShow

{-|
Charge of the system in the calculation.
-}
type Charge       = Int

{-|
Multiplicity of the system in the calculation.
-}
type Multiplicity = Int

{-|
Type of the referece wavefunction.
-}
data RefWF =
    Restricted
  | Unrestricted
  | RestrictedOpen
  deriving (Show, Eq)
instance NiceShow RefWF where
  niceShow Restricted     = &quot;restricted&quot;
  niceShow Unrestricted   = &quot;unrestricted&quot;
  niceShow RestrictedOpen = &quot;restricted open shell&quot;
  niceComplex Restricted     = &quot;r&quot;
  niceComplex Unrestricted   = &quot;u&quot;
  niceComplex RestrictedOpen = &quot;o&quot;

{-|
Method to calculate derivatives of the energy with respect to coordinates (gradients and hessians).
-}
data DType =
    Analytical
  | Numerical
  | NotAvail
  deriving (Show, Eq)
instance NiceShow DType where
  niceShow Analytical = &quot;analytical&quot;
  niceShow Numerical  = &quot;numerical&quot;
  niceShow NotAvail   = &quot;not available&quot;
  niceComplex Analytical = &quot;a&quot;
  niceComplex Numerical  = &quot;n&quot;
  niceComplex NotAvail   = &quot;x&quot;

{-|
Determines, how the calculation of derivatives can be performed. The records are lists, as it is not
assumed, that e.g. analytical gradients also imply numerical gradients being available.
-}
data Efficiency = Efficiency
  { _has_Gradient          :: [DType]
  , _has_SolventGradient   :: [DType]
  , _has_Hessian           :: [DType]
  , _has_SolventHessian    :: [DType]
  , _has_higherDerivatives :: [DType]
  } deriving (Show, Eq)
makeLenses ''Efficiency
instance NiceShow Efficiency where
  niceShow a =
    &quot;       Gradient        |        Hessian        |     Higher Deriv.     &quot; ++ &quot;\n&quot; ++
    &quot;  GasPhase |  Solvent  |  GasPhase |  Solvent  |                       &quot; ++ &quot;\n&quot; ++
    &quot;-----------+-----------+-----------+-----------+-----------------------&quot; ++ &quot;\n&quot; ++
    printf &quot;  %7s  |  %7s  |  %7s  |  %7s  |  %7s  \n&quot;
      (concatMap niceComplex $ a ^. has_Gradient)
      (concatMap niceComplex $ a ^. has_SolventGradient)
      (concatMap niceComplex $ a ^. has_Hessian)
      (concatMap niceComplex $ a ^. has_SolventHessian)
      (concatMap niceComplex $ a ^. has_higherDerivatives)
  niceComplex a =
    &quot;G-&quot; ++
    (concatMap niceComplex $ a ^. has_Gradient) ++
    &quot;(&quot; ++
    (concatMap niceComplex $ a ^. has_SolventGradient) ++
    &quot;)  &quot; ++
    &quot;H-&quot; ++
    (concatMap niceComplex $ a ^. has_Hessian) ++
    &quot;(&quot; ++
    (concatMap niceComplex $ a ^. has_SolventHessian) ++
    &quot;)  &quot; ++
    &quot;\n&quot;

{-|
Available hamiltonians for semiempirical methods.
-}
data SE_Method =
    SE_XTB1
  | SE_XTB2
  | SE_OM1
  | SE_OM2
  | SE_OM3
  | SE_PM3
  | SE_PM6
  | SE_PM7
  | SE_AM1
  | SE_RM1
  deriving (Eq)
instance Show SE_Method where
  show SE_XTB1 = &quot;GFN-XTB - version 1&quot;
  show SE_XTB2 = &quot;GFN-XTB - version 2&quot;
  show SE_OM1  = &quot;OM(1)&quot;
  show SE_OM2  = &quot;OM(2)&quot;
  show SE_OM3  = &quot;OM(3)&quot;
  show SE_PM3  = &quot;PM3&quot;
  show SE_PM6  = &quot;PM6&quot;
  show SE_PM7  = &quot;PM7&quot;
  show SE_AM1  = &quot;AM1&quot;
  show SE_RM1  = &quot;RM1&quot;
instance NiceShow SE_Method where
  niceShow    = show
  niceComplex = show


-- | Hartree Fock
-- |   -&gt; Approximations
data HF_Approx =
    HF_None
  | HF_RIJK
  | HF_RIJONX
  | HF_RIJCOSX
  deriving (Eq)
instance Show HF_Approx where
  show HF_None    = &quot;None&quot;
  show HF_RIJK    = &quot;RI-JK&quot;
  show HF_RIJONX  = &quot;RI-JONX&quot;
  show HF_RIJCOSX = &quot;RI-JCOSX&quot;

{-|
Available density functionals in density functional theory calculations.
-}
data DFT_Functional =
  -- LDA
    DFT_PWLDA
  | DFT_VWN3
  | DFT_VWN5
  -- GGA
  | DFT_BLYP
  | DFT_OLYP
  | DFT_GLYP
  | DFT_XLYP
  | DFT_PW91
  | DFT_MPWPW
  | DFT_MPWLYP
  | DFT_PBE
  | DFT_RPBE
  | DFT_REVPBE
  | DFT_PWP
  -- metaGGA
  | DFT_M06_L
  | DFT_M11_L
  | DFT_TPSS
  -- Hybrid
  | DFT_B1LYP
  | DFT_B3LYP
  | DFT_O3LYP
  | DFT_X3LYP
  | DFT_BP86
  | DFT_PBE0
  | DFT_BHANDHLYP
  -- metaHybrid
  | DFT_M06
  | DFT_M06_2X
  | DFT_TPSS0
  | DFT_TPSSh
  -- range separated Hybrid
  | WB97
  | WB97X
  | WB97X_D3
  | CAM_B3LYP
  | LV_BLYP
  -- doubleHybrid
  | DFT_B2PLYP
  | DFT_B2PLYP_RI
  | DFT_B2PLYP_D
  | DFT_B2PLYP_D3
  | DFT_MPW2PLYP
  | DFT_MPW2PLYP_D
  | DFT_B2GP_PLYP
  | DFT_B2K_PLYP
  | DFT_B2T_PLYP
  | DFT_PWPB95
  | DFT_PBPB95_RI
  deriving (Eq, Show)

{-|
Available approximations to DFT calculations.
-}
data DFT_Approx =
    DFT_None     -- ^ Conventional DFT without integral approximations
  | DFT_RIJ      -- ^ Density fitting of the Coulomb integrals.
  | DFT_RIJK     -- ^ Density fitting of the Coulomb and exchange integrals.
  | DFT_RIJCOSX  -- ^ ORCA's methods with &quot;normal&quot; fitting of Coulomb integrals and chain of spheres
                 --   fitting for exchange.
  | DFT_RIJONX   -- ^ ORCA's methods with &quot;normal&quot; fitting of Coulomb integrals and alternative
                 --   fitting of exchange integrals
  deriving (Eq)
instance Show DFT_Approx where
  show DFT_None    = &quot;none&quot;
  show DFT_RIJ     = &quot;RI-J&quot;
  show DFT_RIJK    = &quot;RI-JK&quot;
  show DFT_RIJCOSX = &quot;RI-JCOSX&quot;
  show DFT_RIJONX  = &quot;RI-JONX&quot;

{-|
Order of the pertubation theory expansion in M&#248;ller-Plesset theory calculations.
-}
data MP_Order =
    MP_N2
  | MP_N2_5
  | MP_N3
  | MP_N4
  | MP_N5
  deriving (Eq)
instance Show MP_Order where
  show MP_N2   = &quot;2&quot;
  show MP_N2_5 = &quot;2.5&quot;
  show MP_N3   = &quot;3&quot;
  show MP_N4   = &quot;4&quot;
  show MP_N5   = &quot;5&quot;

{-|
The type of the M&#248;ller-Plesset calculation.
-}
data MP_Flavour =
    MP_Conv -- ^ Canonical/Conventional M&#248;ller-Plesset theory.
  | MP_OO   -- ^ Orbital optimised M&#248;ller-Plesset methods.
  | MP_F12  -- ^ Explicitly correlated \( F_{12} \) methods.
  deriving (Eq)
instance Show MP_Flavour where
  show MP_Conv = &quot;conventional&quot;
  show MP_OO   = &quot;orbital optimised&quot;
  show MP_F12  = &quot;explicitly correlated&quot;

{-|
Integral approximations in M&#248;ller-Plesset calculations.
-}
data MP_Approx =
    MP_None  -- ^ No approximations to M&#248;ller-Plesset integrals.
  | MP_RI    -- ^ Use RI-M&#248;ller-Plesset methods (will propably need a RI/C basis).
  | MP_DLPNO -- ^ Domain-based local pair natural orbital approximations applied to M&#248;ller-Plesset
             --   calculations.
  deriving (Eq)
instance Show MP_Approx where
  show MP_None  = &quot;none&quot;
  show MP_RI    = &quot;RI&quot;
  show MP_DLPNO = &quot;DLPNO&quot;

{-|
Coupled cluster truncation level of the calculation.
-}
data CC_Order =
    CC_D    -- ^ CCD
  | CC_SD   -- ^ CCSD
  | CC_SDT  -- ^ CCSDT
  | CC_SDTQ -- ^ CCSDTQ
  | CC_SDt  -- ^ CCSD(T)
  | CC_SDtq -- ^ CCSD(TQ)
  deriving (Eq)
instance Show CC_Order where
  show CC_D    = &quot;CCD&quot;
  show CC_SD   = &quot;CCSD&quot;
  show CC_SDT  = &quot;CCSDT&quot;
  show CC_SDTQ = &quot;CCSDTQ&quot;
  show CC_SDt  = &quot;CCSD(T)&quot;
  show CC_SDtq = &quot;CCSD(TQ)&quot;

{-|
Type of the coupled cluster calculation.
-}
data CC_Flavour =
    CC_Conv -- ^ Convenctional coupled cluster calculation.
  | CC_OO   -- ^ Orbital optimised coupled cluster calculation.
  | CC_LR   -- ^ Locally renormalised coupled cluster calculation.
  | CC_CR   -- ^ Completely renormalised coupled cluster calculation.
  | CC_F12  -- ^ Explicitly correlated \( F_{12} \) coupled cluster calculation.
  deriving (Eq)
instance Show CC_Flavour where
  show CC_Conv = &quot;conventional&quot;
  show CC_OO   = &quot;orbital optimised&quot;
  show CC_LR   = &quot;locally renormalised&quot;
  show CC_CR   = &quot;completely renormalised&quot;
  show CC_F12  = &quot;explicitly correlated&quot;

{-|
Approximations applied for coupled cluster calculations.
-}
data CC_Approx =
    CC_None  -- ^ No approximations applied.
  | CC_RI    -- ^ Density fitted coupled cluster calculation.
  | CC_DLPNO -- ^ Domain based local natural pair orbitals approximation.
  deriving (Eq)
instance Show CC_Approx where
  show CC_None  = &quot;none&quot;
  show CC_RI    = &quot;RI&quot;
  show CC_DLPNO = &quot;DLPNO&quot;

{-|
CASSCF active space selection.
-}
data CAS_Space = CAS_Space
  { _cas_Space_nElec :: Int   -- ^ Number of electrons in the active space.
  , _cas_Space_Orbs  :: [Int] -- ^ List of orbitals in the active space.
  } deriving (Eq)
makeLenses ''CAS_Space
instance Show CAS_Space where
  show a =
    printf &quot;%10s | %10s\n&quot; &quot;electrons&quot; &quot;orbitals&quot; ++
    printf &quot;%10d | %10d %s&quot;   (a ^. cas_Space_nElec) (length $ a ^. cas_Space_Orbs) (show $ a ^. cas_Space_Orbs)

{-|
In state averaging CASSCF the number of roots to calculate.
-}
type CAS_Roots = Int

{-|
The weights of the individual roots in a state averaging CASSCF calculation. Length of this list
should equal 'CAS_Roots'.
-}
type CAS_Weights = [Double]

{-|
Approximations applied to CASSCF calculations.
-}
data CAS_Approx =
    CAS_Conv    -- ^ No approximations in CASSCF calculation.
  | CAS_RIJK    -- ^ Density fitting of both exchange and Coulomb integrals.
  | CAS_RIJONX  -- ^ Density fitting of Coulomb integrals and ORCA's version of exchange integral
                --   fitting.
  | CAS_RIJCOSX -- ^ Density fitting of Coulomb integrals and chain of spheres fitting of exchange
                --   integrals.
  | CAS_DMRG    -- ^ Density Matrix Renormalisation Group approximation of CASSCF. Makes active
                --   space non-invariant againts active-active orbital rotations.
  deriving (Show, Eq)

{-|
Description of a semiempirical calculation capabilities.
-}
data QC_SE = QC_SE
  { _se_method     :: SE_Method
  , _se_ref        :: RefWF
  , _se_efficiency :: Efficiency
  } deriving (Eq, Show)
makeLenses ''QC_SE

{-|
Description of a Hartree-Fock calculation.
-}
data QC_HF = QC_HF
  { _hf_approx     :: HF_Approx
  , _hf_ref        :: RefWF
  , _hf_efficiency :: Efficiency
  } deriving (Eq, Show)
makeLenses ''QC_HF

{-|
Description of a DFT calculation.
-}
data QC_DFT = QC_DFT
  { _dft_functional :: DFT_Functional
  , _dft_ref        :: RefWF
  , _dft_approx     :: DFT_Approx
  , _dft_efficiency :: Efficiency
  } deriving (Eq, Show)
makeLenses ''QC_DFT

{-|
Description of a Moller-Plesset calculation.
-}
data QC_MPN = QC_MPN
  { _mpn_flavour    :: MP_Flavour
  , _mpn_order      :: MP_Order
  , _mpn_approx     :: MP_Approx
  , _mpn_ref        :: RefWF
  , _mpn_efficiency :: Efficiency
  } deriving (Eq, Show)
makeLenses ''QC_MPN

{-|
Description of a coupled cluster calculation.
-}
data QC_CC = QC_CC
  { _cc_order      :: CC_Order
  , _cc_flavour    :: CC_Flavour
  , _cc_ref        :: RefWF
  , _cc_approx     :: CC_Approx
  , _cc_efficiency :: Efficiency
  } deriving (Eq, Show)
makeLenses ''QC_CC

{-|
Description of a CASSCF calculation capabilities.
-}
data QC_CAS = QC_CAS
  { _cas_approx     :: CAS_Approx
  , _cas_efficiency :: Efficiency
  } deriving (Eq, Show)
makeLenses ''QC_CAS

{-|
A data type, which is designed only for holding quantum chemical capabilities.
-}
data Methods = Methods
  { _methods_qc_SE  :: [QC_SE]  -- ^ Semiempirical methods.
  , _methods_qc_HF  :: [QC_HF]  -- ^ Hartee-Fock.
  , _methods_qc_DFT :: [QC_DFT] -- ^ Density functional theory.
  , _methods_qc_MPN :: [QC_MPN] -- ^ Moller-Plesset theory.
  , _methods_qc_CC  :: [QC_CC]  -- ^ Coupled cluster.
  , _methods_qc_CAS :: [QC_CAS] -- ^ CASSCF.
  } deriving (Eq, Show)
makeLenses ''Methods
-}</span><span>
</span><a name="line-681"></a></pre></body></html>