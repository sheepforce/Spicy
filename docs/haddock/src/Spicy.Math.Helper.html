<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Spicy.Math.Helper
Description : Basic mathematical operations, auxiliary functions for runQ
Copyright   : Phillip Seeber, 2019
License     : GPL-3
Maintainer  : phillip.seeber@uni-jena.de
Stability   : experimental
Portability : POSIX, Windows

Definitions of auxiliary functions to deal with the GHC bug, making it necessary to have all
'A.runQ' expressions as untyped slices. Functions in this module are not meant for direct use, but
wrapped in the 'Spicy.Math' module.
-}</span><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Spicy.Math.Helper</span><span>
</span><a name="line-15"></a><span class="hs-special">(</span><span> </span><a href="Spicy.Math.Helper.html#vvP"><span class="hs-identifier hs-var">vvP</span></a><span>
</span><a name="line-16"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.Helper.html#vmP"><span class="hs-identifier hs-var">vmP</span></a><span>
</span><a name="line-17"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.Helper.html#mvP"><span class="hs-identifier hs-var">mvP</span></a><span>
</span><a name="line-18"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.Helper.html#mmP"><span class="hs-identifier hs-var">mmP</span></a><span>
</span><a name="line-19"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Array.Accelerate</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- import qualified Data.Array.Accelerate.LLVM.Native           as A</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Array.Accelerate.Numeric.LinearAlgebra</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">{-|
Vector vector dot product.
-}</span><span>
</span><a name="line-28"></a><span class="hs-identifier">vvP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Scalar</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><a name="vvP"><a href="Spicy.Math.Helper.html#vvP"><span class="hs-identifier">vvP</span></a></a><span> </span><a name="local-6989586621679097346"><a href="#local-6989586621679097346"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679097347"><a href="#local-6989586621679097347"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097346"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;.&gt;</span><span> </span><a href="#local-6989586621679097347"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">{-|
Vector matrix product.
-}</span><span>
</span><a name="line-34"></a><span class="hs-identifier">vmP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Matrix</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><a name="vmP"><a href="Spicy.Math.Helper.html#vmP"><span class="hs-identifier">vmP</span></a></a><span> </span><a name="local-6989586621679097348"><a href="#local-6989586621679097348"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679097349"><a href="#local-6989586621679097349"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097348"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">&lt;#</span><span> </span><a href="#local-6989586621679097349"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">{-|
Matrix vector product.
-}</span><span>
</span><a name="line-40"></a><span class="hs-identifier">mvP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Matrix</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><a name="mvP"><a href="Spicy.Math.Helper.html#mvP"><span class="hs-identifier">mvP</span></a></a><span> </span><a name="local-6989586621679097350"><a href="#local-6989586621679097350"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679097351"><a href="#local-6989586621679097351"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097350"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">#&gt;</span><span> </span><a href="#local-6989586621679097351"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">{-|
Matrix matrix product.
-}</span><span>
</span><a name="line-46"></a><span class="hs-identifier">mmP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Matrix</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Matrix</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Matrix</span><span> </span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><a name="mmP"><a href="Spicy.Math.Helper.html#mmP"><span class="hs-identifier">mmP</span></a></a><span> </span><a name="local-6989586621679097352"><a href="#local-6989586621679097352"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679097353"><a href="#local-6989586621679097353"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097352"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679097353"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-48"></a></pre></body></html>