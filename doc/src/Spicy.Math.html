<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Spicy.Math
Description : Basic mathematical operations
Copyright   : Phillip Seeber, 2019
License     : GPL-3
Maintainer  : phillip.seeber@uni-jenVS.de
Stability   : experimental
Portability : POSIX, Windows

This module defines basic algebraic operations used throughout the program. Numerical heavy and most
other operations are implemented using Accelerate, to provide parallel operations. Note that all
'VS.runQ' provided functions must be typed without typeclasses but by concrete types.

The operations here accept some insecurities (like not checking if both vectors of a dot product
have equal lenght) and trust the caller.

-}</span><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Spicy.Math</span><span>
</span><a name="line-19"></a><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="Spicy.Math.html#%2229"><span class="hs-operator hs-var">&#8745;</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Spicy.Math.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.html#vLength"><span class="hs-identifier hs-var">vLength</span></a><span>
</span><a name="line-22"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.html#vDistance"><span class="hs-identifier hs-var">vDistance</span></a><span>
</span><a name="line-23"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.html#vAngle"><span class="hs-identifier hs-var">vAngle</span></a><span>
</span><a name="line-24"></a><span class="hs-special">,</span><span> </span><a href="Spicy.Math.html#vCross"><span class="hs-identifier hs-var">vCross</span></a><span>
</span><a name="line-25"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Array.Accelerate</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">A</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Array.Accelerate.LLVM.Native</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">A</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector</span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VB</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Vector.Storable</span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">VS</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Prelude</span><span>                           </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Spicy.Math.Internal.html"><span class="hs-identifier">Spicy.Math.Internal</span></a><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">{-
(&lt;!!&gt;) :: (VS.Shape sh, VS.Elt e) =&gt; VS.Array sh e -&gt; Int -&gt; e
arr &lt;!!&gt; ix =
  let accAtIx = VS.runQ $ VS.unit $ arr VS.!! ix :: VS.Scalar e
      atIx = head . VS.toList $ accAtIx
  in  atIx
  -}</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">{-|
Intersection (subset) of two lists a and b.
-}</span><span>
</span><a name="line-47"></a><span class="hs-special">(</span><span class="hs-operator">&#8745;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679296134"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679296134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679296134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679296134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-48"></a><a name="local-6989586621679296135"><a href="#local-6989586621679296135"><span class="hs-identifier">a</span></a></a><span> </span><a name="%2229"><a href="Spicy.Math.html#%2229"><span class="hs-operator">&#8745;</span></a></a><span> </span><a name="local-6989586621679296136"><a href="#local-6989586621679296136"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296135"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">intersect</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679296136"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">{-|
Dot product of two 'VS.Vector's.
-}</span><span>
</span><a name="line-53"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">VS.Storable</span><span> </span><a href="#local-6989586621679296133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679296133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296133"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296133"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679296133"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-54"></a><a name="local-6989586621679296291"><a href="#local-6989586621679296291"><span class="hs-identifier">a</span></a></a><span> </span><a name="%3C.%3E"><a href="Spicy.Math.html#%3C.%3E"><span class="hs-operator">&lt;.&gt;</span></a></a><span> </span><a name="local-6989586621679296292"><a href="#local-6989586621679296292"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VS.sum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">VS.zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679296291"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679296292"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">{-|
Length of a 'VS.Vector'.
-}</span><span>
</span><a name="line-59"></a><span class="hs-identifier">vLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">VS.Storable</span><span> </span><a href="#local-6989586621679296132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679296132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296132"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679296132"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-60"></a><a name="vLength"><a href="Spicy.Math.html#vLength"><span class="hs-identifier">vLength</span></a></a><span> </span><a name="local-6989586621679296293"><a href="#local-6989586621679296293"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679296293"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Spicy.Math.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621679296293"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{-|
Distance between 2 points ('VS.Vector's).
-}</span><span>
</span><a name="line-65"></a><span class="hs-identifier">vDistance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">VS.Storable</span><span> </span><a href="#local-6989586621679296131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679296131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296131"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296131"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679296131"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-66"></a><a name="vDistance"><a href="Spicy.Math.html#vDistance"><span class="hs-identifier">vDistance</span></a></a><span> </span><a name="local-6989586621679296294"><a href="#local-6989586621679296294"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679296295"><a href="#local-6989586621679296295"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Spicy.Math.html#vLength"><span class="hs-identifier hs-var">vLength</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">VS.zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679296294"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679296295"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">{-|
Angle in radian between 2 'VS.Vector's.
-}</span><span>
</span><a name="line-71"></a><span class="hs-identifier">vAngle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">VS.Storable</span><span> </span><a href="#local-6989586621679296130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679296130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296130"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><a href="#local-6989586621679296130"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679296130"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-72"></a><a name="vAngle"><a href="Spicy.Math.html#vAngle"><span class="hs-identifier">vAngle</span></a></a><span> </span><a name="local-6989586621679296296"><a href="#local-6989586621679296296"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679296297"><a href="#local-6989586621679296297"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679296296"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Spicy.Math.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621679296297"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Spicy.Math.html#vLength"><span class="hs-identifier hs-var">vLength</span></a><span> </span><a href="#local-6989586621679296296"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Spicy.Math.html#vLength"><span class="hs-identifier hs-var">vLength</span></a><span> </span><a href="#local-6989586621679296297"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">{-|
3D cross product of 2 'VS.Vectors'
-}</span><span>
</span><a name="line-77"></a><span class="hs-identifier">vCross</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">VS.Vector</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-78"></a><a name="vCross"><a href="Spicy.Math.html#vCross"><span class="hs-identifier">vCross</span></a></a><span> </span><a name="local-6989586621679296298"><a href="#local-6989586621679296298"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679296299"><a href="#local-6989586621679296299"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-79"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679296300"><a href="#local-6989586621679296300"><span class="hs-identifier">a1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296298"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">VS.!</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-80"></a><span>      </span><a name="local-6989586621679296301"><a href="#local-6989586621679296301"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296298"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">VS.!</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-81"></a><span>      </span><a name="local-6989586621679296302"><a href="#local-6989586621679296302"><span class="hs-identifier">a3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296298"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">VS.!</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-82"></a><span>      </span><a name="local-6989586621679296303"><a href="#local-6989586621679296303"><span class="hs-identifier">b1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296299"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">VS.!</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-83"></a><span>      </span><a name="local-6989586621679296304"><a href="#local-6989586621679296304"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296299"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">VS.!</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-84"></a><span>      </span><a name="local-6989586621679296305"><a href="#local-6989586621679296305"><span class="hs-identifier">b3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296299"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">VS.!</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-85"></a><span>      </span><a name="local-6989586621679296306"><a href="#local-6989586621679296306"><span class="hs-identifier">c1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296301"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679296305"><span class="hs-identifier hs-var">b3</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679296302"><span class="hs-identifier hs-var">a3</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679296304"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-86"></a><span>      </span><a name="local-6989586621679296307"><a href="#local-6989586621679296307"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296302"><span class="hs-identifier hs-var">a3</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679296303"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679296300"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679296305"><span class="hs-identifier hs-var">b3</span></a><span>
</span><a name="line-87"></a><span>      </span><a name="local-6989586621679296308"><a href="#local-6989586621679296308"><span class="hs-identifier">c3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679296300"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679296304"><span class="hs-identifier hs-var">b2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679296301"><span class="hs-identifier hs-var">a2</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679296303"><span class="hs-identifier hs-var">b1</span></a><span>
</span><a name="line-88"></a><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier hs-var">VS.fromList</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679296306"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679296307"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679296308"><span class="hs-identifier hs-var">c3</span></a><span class="hs-special">]</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">{-
-- | Defines the normal vector of a plane, defined by 3 points
r3VecNormalVecOfPlane3Points :: (Vector R, Vector R, Vector R) -&gt; Vector R
r3VecNormalVecOfPlane3Points (a, b, c) = (b - a) `cross` (c - a)

-- | Dihedral angle between 4 atoms
r3VecDihedral :: (Vector R, Vector R, Vector R, Vector R) -&gt; R
r3VecDihedral (a, b, c, d) = hmVecAngle (p1Normal, p2Normal)
  where
    p1Normal = r3VecNormalVecOfPlane3Points (a, b, c)
    p2Normal = r3VecNormalVecOfPlane3Points (b, c, d)

-- vectorProduct :: VS.Vector Double -&gt; VS.Vector Double -&gt; VS.Scalar Double
-- vectorProduct = $( VS.runQ vectorProduct' )
-}</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">----------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- Helper functions, not to be exported</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">{-|
Convert
-}</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">{-
parVector :: NFData a =&gt; Strategy (V.Vector a)
parVector vec =
  let vLen = V.length vec
      half = vLen `div` 2
      minChunk = 10
  in  if vLen &gt; minChunk
      then do
        let v1 = V.unsafeSlice 0 half vec
            v2 = V.unsafeSlice half (vLen - half) vec
        parVector v1
        parVector v2
        return vec
      else
        evalChunk (vLen-1) &gt;&gt;
        return vec
  where
  evalChunk 0 = rpar (rdeepseq (vec V.! 0)) &gt;&gt; return vec
  evalChunk i = rpar (rdeepseq (vec V.! i)) &gt;&gt; evalChunk (i-1)
-}</span><span>
</span><a name="line-134"></a></pre></body></html>