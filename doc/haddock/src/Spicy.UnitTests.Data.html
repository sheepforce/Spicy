<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Spicy.UnitTests.Data
Description : Auxiliary data for unit tests
Copyright   : Phillip Seeber, 2019
License     : GPL-3
Maintainer  : phillip.seeber@uni-jena.de
Stability   : experimental
Portability : POSIX, Windows

The module collects data only used for unit testing, such as the correct answers for unit tests.
-}</span><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Spicy.UnitTests.Data</span><span>
</span><a name="line-13"></a><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-comment">----------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- Atom and molecules for testing</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">{-
{-|
Empty molecule.
-}
moleculeEmpty :: Molecule
moleculeEmpty = Molecule
  { _molecule_Label    = &quot;&quot;
  , _molecule_Atoms    = VB.empty
  , _molecule_Bonds    = I.empty
  , _molecule_Energy   = Nothing
  , _molecule_Gradient = Nothing
  , _molecule_Hessian  = Nothing
  }

{-|
Define a 'Molecule' HFe(CN)xH2O, with hydrid iron distance being exactly at 1.4 times the sum of the
covalent radii of H and Fe.
-}
atomC0 :: Atom
atomC0 = Atom
  { _atom_Index       = 0
  , _atom_Element     = C
  , _atom_Label       = &quot;C0&quot;
  , _atom_IsPseudo    = False
  , _atom_FFType      = &quot;6&quot;
  , _atom_PCharge     = Just 0.5
  , _atom_Coordinates = VS.fromList [0.000960, -0.001240, 0.281420]
  }

atomN1 :: Atom
atomN1 = Atom
  { _atom_Index       = 1
  , _atom_Element     = N
  , _atom_Label       = &quot;N1&quot;
  , _atom_IsPseudo    = False
  , _atom_FFType      = &quot;7&quot;
  , _atom_PCharge     = Just (-0.5)
  , _atom_Coordinates = VS.fromList [0.000960, -0.001240,-0.875780]
  }

atomFe2 :: Atom
atomFe2 = Atom
  { _atom_Index       = 2
  , _atom_Element     = Fe
  , _atom_Label       = &quot;Fe2&quot;
  , _atom_IsPseudo    = False
  , _atom_FFType      = &quot;26&quot;
  , _atom_PCharge     = Just 1.4
  , _atom_Coordinates = VS.fromList [0.000450, -0.000610, 2.307300]
  }

atomH3 :: Atom
atomH3 = Atom
  { _atom_Index       = 3
  , _atom_Element     = H
  , _atom_Label       = &quot;H3&quot;
  , _atom_IsPseudo    = True
  , _atom_FFType      = &quot;1&quot;
  , _atom_PCharge     = Just 0.4
  , _atom_Coordinates = VS.fromList [0.002370,  0.003010, 4.869300]
  }

atomO4 :: Atom
atomO4 = Atom
  { _atom_Index       = 4
  , _atom_Element     = O
  , _atom_Label       = &quot;O4&quot;
  , _atom_IsPseudo    = False
  , _atom_FFType      = &quot;8&quot;
  , _atom_PCharge     = Just (-0.8)
  , _atom_Coordinates = VS.fromList [2.059230, -2.830320, 3.280180]
  }

atomH5 :: Atom
atomH5 = Atom
  { _atom_Index       = 5
  , _atom_Element     = H
  , _atom_Label       = &quot;H5&quot;
  , _atom_IsPseudo    = False
  , _atom_FFType      = &quot;1&quot;
  , _atom_PCharge     = Nothing
  , _atom_Coordinates = VS.fromList [2.096560, -2.818240, 2.290710]
  }

atomH6 :: Atom
atomH6 = Atom
  { _atom_Index       = 6
  , _atom_Element     = H
  , _atom_Label       = &quot;H6&quot;
  , _atom_IsPseudo    = True
  , _atom_FFType      = &quot;1&quot;
  , _atom_PCharge     = Just 0.4
  , _atom_Coordinates = VS.fromList [2.708520, -2.137580, 3.561450]
  }

{-|
Test 'Molecule' with all information a 'Molecule' could have.
-}
moleculeHFeCNxH2O :: Molecule
moleculeHFeCNxH2O = Molecule
  { _molecule_Label    = &quot;HFe(CN)xH2O&quot;
  , _molecule_Atoms    = VB.fromList
      [ atomC0
      , atomN1
      , atomFe2
      , atomH3
      , atomO4
      , atomH5
      , atomH6
      ]
  , _molecule_Bonds    = IM.fromList
      [ (0, IS.fromList [1,2]) -- C0
      , (1, IS.fromList [0])   -- N1
      , (2, IS.fromList [0,3]) -- Fe2
      , (3, IS.fromList [2])   -- H3
      , (4, IS.fromList [5])   -- O4
      , (5, IS.fromList [4])   -- H5
      , (6, IS.empty)          -- H6
      ]
  , _molecule_Energy   = Just (-1000.0)
  , _molecule_Gradient = Just $ VS.fromList . map fromInteger $ [1 .. 21]
  , _molecule_Hessian  = Nothing -- Just $ A.fromList (A.Z A.:. 21 A.:. 21) . map fromInteger $ [1 .. 441]
  }

{-|
Test 'Molecule' with all informations a TXYZ could have (without calling Tinker).
-}
moleculeHFeCNxH2OTXYZ :: Molecule
moleculeHFeCNxH2OTXYZ = moleculeHFeCNxH2O
  &amp; molecule_Atoms    .~ newAtoms
  &amp; molecule_Energy   .~ Nothing
  &amp; molecule_Gradient .~ Nothing
  &amp; molecule_Hessian  .~ Nothing
  where
    oldAtoms = moleculeHFeCNxH2O ^. molecule_Atoms
    newAtoms = VB.map
      ( (&amp; atom_Label    .~ &quot;&quot;)
      . (&amp; atom_PCharge  .~ Nothing)
      . (&amp; atom_IsPseudo .~ False)
      ) oldAtoms

{-|
Test 'Molecule' with all informations a XYZ could have.
-}
moleculeHFeCNxH2OXYZ :: Molecule
moleculeHFeCNxH2OXYZ = moleculeHFeCNxH2O
  &amp; molecule_Atoms    .~ newAtoms
  &amp; molecule_Bonds    .~ IM.empty
  &amp; molecule_Energy   .~ Nothing
  &amp; molecule_Gradient .~ Nothing
  &amp; molecule_Hessian  .~ Nothing
  where
    oldAtoms = moleculeHFeCNxH2O ^. molecule_Atoms
    newAtoms = VB.map
      ( (&amp; atom_Label    .~ &quot;&quot;)
      . (&amp; atom_FFType   .~ &quot;&quot;)
      . (&amp; atom_PCharge  .~ Nothing)
      . (&amp; atom_IsPseudo .~ False)
      ) oldAtoms

{-|
Test 'Molecule' with all informations a TXYZ could have.
-}
moleculeHFeCNxH2OMOL2 :: Molecule
moleculeHFeCNxH2OMOL2 = moleculeHFeCNxH2O
  &amp; molecule_Atoms    .~ newAtoms
  &amp; molecule_Energy   .~ Nothing
  &amp; molecule_Gradient .~ Nothing
  &amp; molecule_Hessian  .~ Nothing
  where
    oldAtoms   = moleculeHFeCNxH2O ^. molecule_Atoms
    newFFTypes = VB.fromList [ &quot;C.1&quot;, &quot;N.pl3&quot;, &quot;Fe&quot;, &quot;H&quot;, &quot;O.3&quot;, &quot;H&quot;, &quot;H&quot; ]
    newAtoms'' = VB.zipWith (\a ft -&gt; a &amp; atom_FFType .~ ft) oldAtoms newFFTypes
    newAtoms'  = VB.map
      ( (&amp; atom_IsPseudo .~ False)
      ) newAtoms''
    newAtoms   = newAtoms' &amp; (ix 5 . atom_PCharge) .~ Just 0.5

{-|
Test 'Molecule' as TXYZ file.
-}
textHFeCNxH2OTXYZ :: Text
textHFeCNxH2OTXYZ = T.pack . concat $
  [ &quot;     7 HFe(CN)xH2O\n&quot;
  , &quot;    1  C      0.000960   -0.001240    0.281420     6     2     3     \n&quot;
  , &quot;    2  N      0.000960   -0.001240   -0.875780     7     1           \n&quot;
  , &quot;    3 Fe      0.000450   -0.000610    2.307300    26     1     4     \n&quot;
  , &quot;    4  H     -0.002370    0.003010    4.869300     1     3           \n&quot;
  , &quot;    5  O      2.059230   -2.830320    3.280180     8     6           \n&quot;
  , &quot;    6  H      2.096560   -2.818240    2.290710     1     5           \n&quot;
  , &quot;    7  H      2.708520   -2.137580    3.561450     1                 \n&quot;
  ]

{-|
Test 'Molecule' as XYZ file.
-}
testHFeCNxH2OXYZ :: Text
testHFeCNxH2OXYZ = T.pack . concat $
  [ &quot; 7                                         \n&quot;
  , &quot;HFe(CN)xH2O\n&quot;
  , &quot;C         0.000960   -0.001240    0.281420 \n&quot;
  , &quot;N         0.000960   -0.001240   -0.875780 \n&quot;
  , &quot;Fe        0.000450   -0.000610    2.307300 \n&quot;
  , &quot;H        -0.002370    0.003010    4.869300 \n&quot;
  , &quot;O         2.059230   -2.830320    3.280180 \n&quot;
  , &quot;H         2.096560   -2.818240    2.290710 \n&quot;
  , &quot;H         2.708520   -2.137580    3.561450 \n&quot;
  ]

{-|
Test 'Molecule' as MOL2 file.
-}
testHFeCNxH2OMOL2 :: Text
testHFeCNxH2OMOL2 = T.pack . concat $
  [ &quot;@&lt;TRIPOS&gt;MOLECULE\n&quot;
  , &quot;HFe(CN)xH2O\n&quot;
  , &quot; 7 5 0 0 0                                                                    \n&quot;
  , &quot;SMALL                                                                         \n&quot;
  , &quot;GASTEIGER                                                                     \n&quot;
  , &quot;                                                                              \n&quot;
  , &quot;@&lt;TRIPOS&gt;ATOM\n&quot;
  , &quot;      1 C0          0.000960   -0.001240    0.281420 C.1     1  UNL1        0.5000 \n&quot;
  , &quot;      2 N1          0.000960   -0.001240   -0.875780 N.pl3   1  UNL1       -0.5000 \n&quot;
  , &quot;      3 Fe2         0.000450   -0.000610    2.307300 Fe      1  UNL1        1.4000 \n&quot;
  , &quot;      4 H3         -0.002370    0.003010    4.869300 H       1  UNL1        0.4000 \n&quot;
  , &quot;      5 O4          2.059230   -2.830320    3.280180 O.3     1  UNL1       -0.8000 \n&quot;
  , &quot;      6 H5          2.096560   -2.818240    2.290710 H       0  HOH0        0.5000 \n&quot;
  , &quot;      7 H6          2.708520   -2.137580    3.561450 H       0  HOH0        0.4000 \n&quot;
  , &quot;@&lt;TRIPOS&gt;BOND\n&quot;
  , &quot;         1         1         2         1\n&quot;
  , &quot;         2         1         3         1\n&quot;
  , &quot;         3         3         4         1\n&quot;
  , &quot;         4         5         6         1\n&quot;
  , &quot;\n&quot;
  ]

{-|
Test 'Molecule' as Spicy file.
-}
testHFeCNxH2OSpicy :: Text
testHFeCNxH2OSpicy = T.pack . concat $
  [ &quot;#Spicy-Format v0.2\n&quot;
  , &quot;\n&quot;
  , &quot;#Spicy-Molecule\n&quot;
  , &quot;  Label:\n&quot;
  , &quot;    HFe(CN)xH2O\n&quot;
  , &quot;  Energy / Hartree:\n&quot;
  , &quot;         -1.0000000000e3\n&quot;
  , &quot;  Gradient / Hartee/Bohr:\n&quot;
  , &quot;     1.00000     2.00000     3.00000\n&quot;
  , &quot;     4.00000     5.00000     6.00000\n&quot;
  , &quot;     7.00000     8.00000     9.00000\n&quot;
  , &quot;    10.00000    11.00000    12.00000\n&quot;
  , &quot;    13.00000    14.00000    15.00000\n&quot;
  , &quot;    16.00000    17.00000    18.00000\n&quot;
  , &quot;    19.00000    20.00000    21.00000\n&quot;
  , &quot;  Hessian / a.u.:\n&quot;
  , &quot;    (6&gt;&lt;6)\n&quot;
  , &quot;     [  1.0, 21.0, 21.0, 21.0, 21.0, 21.0\n&quot;
  , &quot;     , 21.0,  2.0, 21.0, 21.0, 21.0, 21.0\n&quot;
  , &quot;     , 21.0, 21.0,  3.0, 21.0, 21.0, 21.0\n&quot;
  , &quot;     , 21.0, 21.0, 21.0,  4.0, 21.0, 21.0\n&quot;
  , &quot;     , 21.0, 21.0, 21.0, 21.0,  5.0, 21.0\n&quot;
  , &quot;     , 21.0, 21.0, 21.0, 21.0, 21.0,  6.0 ]\n&quot;
  , &quot;\n&quot;
  , &quot;#Spicy-Atoms\n&quot;
  , &quot;    C        C0              6     0.50000        0.0009600000     -0.0012400000      0.2814200000         1         2  \n&quot;
  , &quot;    N        N1              7    -0.50000        0.0009600000     -0.0012400000     -0.8757800000         0  \n&quot;
  , &quot;   Fe       Fe2             26     1.40000        0.0004500000     -0.0006100000      2.3073000000         0         3  \n&quot;
  , &quot;    H        H3    P         1     0.40000       -0.0023700000      0.0030100000      4.8693000000         2  \n&quot;
  , &quot;    O        O4              8    -0.80000        2.0592300000     -2.8303200000      3.2801800000         5  \n&quot;
  , &quot;    H        H5              1          No        2.0965600000     -2.8182400000      2.2907100000         4  \n&quot;
  , &quot;    H        H6    P         1     0.40000        2.7085200000     -2.1375800000      3.5614500000  \n&quot;
  ]
-}</span><span>
</span><a name="line-295"></a></pre></body></html>