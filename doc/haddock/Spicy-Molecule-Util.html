<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Spicy.Molecule.Util</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Spicy.Molecule.Util.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">spicy-0.0.0.1</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Phillip Seeber 2019</td></tr><tr><th>License</th><td>GPL-3</td></tr><tr><th>Maintainer</th><td>phillip.seeber@uni-jena.de</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>POSIX, Windows</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Spicy.Molecule.Util</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides functions to manipulate basic data structures of <code><a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a></code>s, such as indexing.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:checkMolecule">checkMolecule</a> :: <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a> -&gt; <a href="../accelerate-1.3.0.0/Data-Array-Accelerate-Data-Either.html#t:Either" title="Data.Array.Accelerate.Data.Either">Either</a> <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a></li><li class="src short"><a href="#v:reIndexMolecule">reIndexMolecule</a> :: <a href="../containers-0.6.0.1/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a> <a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Int" title="Data.Array.Accelerate">Int</a> -&gt; <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a> -&gt; <a href="../accelerate-1.3.0.0/Data-Array-Accelerate-Data-Either.html#t:Either" title="Data.Array.Accelerate.Data.Either">Either</a> <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a></li><li class="src short"><a href="#v:groupTupleSeq">groupTupleSeq</a> :: <a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> (<a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Int" title="Data.Array.Accelerate">Int</a>, <a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Int" title="Data.Array.Accelerate">Int</a>) -&gt; <a href="../containers-0.6.0.1/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a> <a href="../containers-0.6.0.1/Data-IntSet.html#t:IntSet" title="Data.IntSet">IntSet</a></li><li class="src short"><a href="#v:groupBy">groupBy</a> :: (a -&gt; a -&gt; <a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Bool" title="Data.Array.Accelerate">Bool</a>) -&gt; <a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> a -&gt; <a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> (<a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> a)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:checkMolecule" class="def">checkMolecule</a> :: <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a> -&gt; <a href="../accelerate-1.3.0.0/Data-Array-Accelerate-Data-Either.html#t:Either" title="Data.Array.Accelerate.Data.Either">Either</a> <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a> <a href="src/Spicy.Molecule.Util.html#checkMolecule" class="link">Source</a> <a href="#v:checkMolecule" class="selflink">#</a></p><div class="doc"><p>Check if a single <code><a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a></code> layer has sane indices (<code><a href="../containers-0.6.0.1/Data-IntSet.html#t:Key" title="Data.IntSet">Key</a></code>) in the <code><a href="../containers-0.6.0.1/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a></code> for <code><a href="Spicy-Types.html#v:_molecule_Atoms" title="Spicy.Types">_molecule_Atoms</a></code>
and <code><a href="Spicy-Types.html#v:_molecule_SubMol" title="Spicy.Types">_molecule_SubMol</a></code>, meaning the bonds do not include <code><a href="Spicy-Types.html#t:Atom" title="Spicy.Types">Atom</a></code>s, that do not exist. Then
recursively check if the <code><a href="Spicy-Types.html#t:Atom" title="Spicy.Types">Atom</a></code>s of deeper layers are proper subsets of the higher layer, both for
<code><a href="Spicy-Types.html#v:_molecule_Atoms" title="Spicy.Types">_molecule_Atoms</a></code> and <code><a href="Spicy-Types.html#v:_molecule_Bonds" title="Spicy.Types">_molecule_Bonds</a></code>. Also checks if fragments of the same layer are disjoint.
Returns the <code><a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a></code> without modifications if it is sane, a string with description of the found
problem otherwise. This check is exhaustive and potentially expensive.</p></div></div><div class="top"><p class="src"><a id="v:reIndexMolecule" class="def">reIndexMolecule</a> :: <a href="../containers-0.6.0.1/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a> <a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Int" title="Data.Array.Accelerate">Int</a> -&gt; <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a> -&gt; <a href="../accelerate-1.3.0.0/Data-Array-Accelerate-Data-Either.html#t:Either" title="Data.Array.Accelerate.Data.Either">Either</a> <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a> <a href="src/Spicy.Molecule.Util.html#reIndexMolecule" class="link">Source</a> <a href="#v:reIndexMolecule" class="selflink">#</a></p><div class="doc"><p>Reindex a complete <code><a href="Spicy-Types.html#t:Molecule" title="Spicy.Types">Molecule</a></code>, including all its deeper layers in <code><a href="Spicy-Types.html#v:_molecule_SubMol" title="Spicy.Types">_molecule_SubMol</a></code>) by mappings
from a global replacement Map, mapping old to new indices. This function assumes, that your molecule
is sane in the overall assumptions of this program. This means that the lower layers obey the
counting scheme of the atoms of the higher layers and pseudoatoms come last.</p></div></div><div class="top"><p class="src"><a id="v:groupTupleSeq" class="def">groupTupleSeq</a> :: <a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> (<a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Int" title="Data.Array.Accelerate">Int</a>, <a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Int" title="Data.Array.Accelerate">Int</a>) -&gt; <a href="../containers-0.6.0.1/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a> <a href="../containers-0.6.0.1/Data-IntSet.html#t:IntSet" title="Data.IntSet">IntSet</a> <a href="src/Spicy.Molecule.Util.html#groupTupleSeq" class="link">Source</a> <a href="#v:groupTupleSeq" class="selflink">#</a></p><div class="doc"><p>Group by the first tuple element and within this group build an IntSet of the the second tuple
elements.</p></div></div><div class="top"><p class="src"><a id="v:groupBy" class="def">groupBy</a> :: (a -&gt; a -&gt; <a href="../accelerate-1.3.0.0/Data-Array-Accelerate.html#t:Bool" title="Data.Array.Accelerate">Bool</a>) -&gt; <a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> a -&gt; <a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> (<a href="../containers-0.6.0.1/Data-Sequence.html#t:Seq" title="Data.Sequence">Seq</a> a) <a href="src/Spicy.Molecule.Util.html#groupBy" class="link">Source</a> <a href="#v:groupBy" class="selflink">#</a></p><div class="doc"><p>This function implements
[groupBy](http:/<em>hackage.haskell.org</em>package<em>base-4.12.0.0</em>docs/Data-List.html#v:groupBy) as in
Data.List:
&quot;The group function takes a list and returns a list of lists such that the concatenation of the
result is equal to the argument. Moreover, each sublist in the result contains only equal elements.&quot;</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>